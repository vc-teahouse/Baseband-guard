menu "Baseband Security Guard Configuration"

config SECURITY_BASEBAND_GUARD
       bool "Enable Baseband Guard (Anti-Format)" 
       default y
       depends on SECURITY
       help
          An Android baseband anti-formatting protector 
          module by Github@showdo, preventing malicious
          scripts or programs writing into important
          function partitions.
          If unsure, leave this y.

config SECURITY_BASEBAND_GUARD_ALLOW_IN_RECOVERY
       bool "Turn off Baseband Protect in Recovery Mode"
       depends on SECURITY_BASEBAND_GUARD
       default y
       help
          Turn off protection in recovery mode, in
          order that repairing system partitions can
          be done in recovery mode.
          If unsure, leave this y.

config SECURITY_BASEBAND_GUARD_BLOCK_BOOT
       bool "Enable Baseband Protect for Boot Partition"
       depends on SECURITY_BASEBAND_GUARD
       default n
       help
          Enable protection for boot partition to
          prevent malicious scripts or programs
          destroying, however this may cause failure
          when flashing kernels in Android system
          (meaning that you'll only be able to flash
          kernels/boot partition image in recovery/
          fastboot mode).
          If unsure, leave this n.

config SECURITY_BASEBAND_GUARD_DEBUG
       bool "Output details to log for debugging"
       depends on SECURITY_BASEBAND_GUARD
       default y
       help
          Output details about rejected requests
          (Rejected process name & domain) to dmesg
          log for debugging.
          If unsure, leave this y.

config SECURITY_BASEBAND_GUARD_ANTI_SPOOF_DOMAIN
       int "Anti Domain Spoof"
       depends on SECURITY_BASEBAND_GUARD
       default 1
       help
          If say 1 here, selinuxfs setenforce will get -EACCES
          every process can't change selinux to permissive

          If say 2 here, when any process change selinux to permissive once
          bbg will not trust every domain

          If say 3 here, bbg will not process spoof domain,
          WARNING: EVERY PROCESS CAN PERMISSIVE SELINUX TO BYPASS BBG IN THIS OPTION
          If unsure, leave this 1. 

endmenu
